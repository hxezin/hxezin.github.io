---
title: 'CSR / SSR with Next.js'
description: 'CSRê³¼ SSRì˜ ê°œë…ê³¼, Next.js í”„ë¡œì íŠ¸ì˜ npm run start ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰ ê³¼ì •ì„ ì•Œì•„ë´…ë‹ˆë‹¤.'
date: '2023-06-29'
category: 'TIL'
tags: ['Next.js']
---

## CSRì´ëž€ ë¬´ì—‡ì¸ê°€?

![](230629.png)

 CSRì€ ì›¹ íŽ˜ì´ì§€ì˜ ë Œë”ë§ í”„ë¡œì„¸ìŠ¤ ì¤‘ í´ë¼ì´ì–¸íŠ¸, ì¦‰ ì‚¬ìš©ìžì˜ ë¸Œë¼ìš°ì €ì—ì„œ ìˆ˜í–‰ë˜ëŠ” ë°©ì‹ì„ ë§í•©ë‹ˆë‹¤. ë¸Œë¼ìš°ì €ì—ì„œ ì„œë²„ë¡œ ìš”ì²­ì„ ë³´ë‚´ë©´ ì„œë²„ëŠ” ë¸Œë¼ìš°ì €ì— ì›¹ íŽ˜ì´ì§€ì˜ ê³¨ê²©ì´ ë  ë‹¨ì¼ íŽ˜ì´ì§€(Single Page)ì™€ íŽ˜ì´ì§€ì— í•„ìš”í•œ ìžë°”ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì „ì†¡í•©ë‹ˆë‹¤. ë¸Œë¼ìš°ì €ëŠ” ì›¹ íŽ˜ì´ì§€ì™€ í•¨ê»˜ ì „ë‹¬ëœ ìžë°”ìŠ¤í¬ë¦½íŠ¸ íŒŒì¼ì„ ì‚¬ìš©í•˜ì—¬ DOMì„ ì—…ë°ì´íŠ¸í•˜ê³  íŽ˜ì´ì§€ë¥¼ ë Œë”ë§í•©ë‹ˆë‹¤.

 ì›¹ íŽ˜ì´ì§€ì— í•„ìš”í•œ ë‚´ìš©ì´ ë°ì´í„°ë² ì´ìŠ¤ì— ì €ìž¥ëœ ë°ì´í„°ì¸ ê²½ìš°, ë¸Œë¼ìš°ì €ëŠ” Fetchì™€ ê°™ì€ APIë¥¼ ì‚¬ìš©í•´ ë°ì´í„°ë² ì´ìŠ¤ì— ì €ìž¥ëœ ë°ì´í„°ë¥¼ ê°€ì ¸ì™€ ì›¹ íŽ˜ì´ì§€ì— ë Œë”ë§í•©ë‹ˆë‹¤.

 ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì²˜ìŒ ë¡œë“œí•  ë•Œ ì‚¬ìš©ìžê°€ ì „ì²´ íŽ˜ì´ì§€ë¥¼ ë³´ê¸°ê¹Œì§€ ì•½ê°„ì˜ ì§€ì—°ì´ ë°œìƒí•  ìˆ˜ ìžˆëŠ”ë°, ì´ëŠ” ëª¨ë“  ìžë°”ìŠ¤í¬ë¦½íŠ¸ê°€ ë‹¤ìš´ë¡œë“œ, êµ¬ë¬¸ ë¶„ì„ ë° ì‹¤í–‰ë  ë•Œê¹Œì§€ íŽ˜ì´ì§€ê°€ ì™„ì „ížˆ ë Œë”ë§ë˜ì§€ ì•Šê¸° ë•Œë¬¸ìž…ë‹ˆë‹¤. ë¸Œë¼ìš°ì €ê°€ ë‹¤ë¥¸ ê²½ë¡œë¡œ ì´ë™í•  ê²½ìš°, CSRì—ì„œëŠ” SSRê³¼ ë‹¤ë¥´ê²Œ ì„œë²„ê°€ ì›¹ íŽ˜ì´ì§€ë¥¼ ë‹¤ì‹œ ë³´ë‚´ì§€ ì•ŠìŠµë‹ˆë‹¤. ë¸Œë¼ìš°ì €ëŠ” ë¸Œë¼ìš°ì €ê°€ ìš”ì²­í•œ ê²½ë¡œì— ë”°ë¼ íŽ˜ì´ì§€ë¥¼ ë‹¤ì‹œ ë Œë”ë§í•©ë‹ˆë‹¤. ì´ë•Œ ë³´ì´ëŠ” ì›¹ íŽ˜ì´ì§€ì˜ íŒŒì¼ì€ ë§¨ ì²˜ìŒ ì„œë²„ë¡œë¶€í„° ì „ë‹¬ë°›ì€ ì›¹ íŽ˜ì´ì§€ íŒŒì¼ê³¼ ë™ì¼í•œ íŒŒì¼ìž…ë‹ˆë‹¤.

### CSRì˜ ìž¥ì 

- **ë›°ì–´ë‚œ ì‚¬ìš©ìž ê²½í—˜**: CSRì€ ì´ˆê¸° íŽ˜ì´ì§€ ë¡œë”© í›„, íŽ˜ì´ì§€ ê°±ì‹ ì´ í•„ìš”í•œ ë¶€ë¶„ë§Œ ì—…ë°ì´íŠ¸í•˜ë¯€ë¡œ ë¹ ë¥¸ ìƒí˜¸ìž‘ìš©ê³¼ ë¶€ë“œëŸ¬ìš´ ì‚¬ìš©ìž ê²½í—˜ì„ ì œê³µí•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤.
- **ìƒí˜¸ìž‘ìš©ì ì¸ ì• í”Œë¦¬ì¼€ì´ì…˜**: ë™ì ì¸ ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ ê°œë°œì— ì í•©í•©ë‹ˆë‹¤. ì‚¬ìš©ìž ìž…ë ¥ì— ì‹¤ì‹œê°„ìœ¼ë¡œ ë°˜ì‘í•˜ê³  ì—…ë°ì´íŠ¸í•  ìˆ˜ ìžˆì–´ ë³µìž¡í•œ ì‚¬ìš©ìž ìƒí˜¸ìž‘ìš©ì„ ë‹¤ë£¨ê¸° ìš©ì´í•©ë‹ˆë‹¤.
- **ë¸Œë¼ìš°ì € ìºì‹± í™œìš©**: CSRì€ ì´ˆê¸°ì— í•„ìš”í•œ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¨ í›„, ì´í›„ì—ëŠ” ë¸Œë¼ìš°ì € ìºì‹±ì„ í†µí•´ ì½˜í…ì¸ ë¥¼ ë¡œë“œí•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤. ì´ëŠ” ë°˜ë³µì ì¸ íŽ˜ì´ì§€ ë¡œë”© ì‹œê°„ì„ ë‹¨ì¶•í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤.
- **ì„œë²„ ë¶€í•˜ ê°ì†Œ**: ì„œë²„ ì¸¡ì—ì„œëŠ” ë¯¸ë¦¬ ì™„ì„±ëœ HTMLì„ ìƒì„±í•˜ê±°ë‚˜ ë°ì´í„°ë¥¼ ì²˜ë¦¬í•˜ì§€ ì•Šì•„ë„ ë˜ë¯€ë¡œ ì„œë²„ ë¶€í•˜ê°€ ìƒëŒ€ì ìœ¼ë¡œ ì ìŠµë‹ˆë‹¤.

## SPAë¡œ êµ¬ì„±ëœ ì•±ì—ì„œ SSRì´ í•„ìš”í•œ ì´ìœ 

ì‹±ê¸€ íŽ˜ì´ì§€ ì• í”Œë¦¬ì¼€ì´ì…˜(SPA)ì€ CSR ë°©ì‹ìœ¼ë¡œ êµ¬í˜„ë˜ì–´ íŽ˜ì´ì§€ ë¡œë”© ë° ì „í™˜ ì‹œì— ìžì—°ìŠ¤ëŸ½ê³  ë¹ ë¥¸ ìƒí˜¸ìž‘ìš©ì„ ì œê³µí•©ë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ ëª‡ ê°€ì§€ ê²½ìš°ì— ì„œë²„ ì‚¬ì´ë“œ ë Œë”ë§ì´ í•„ìš”í•œ ì´ìœ ê°€ ìžˆìŠµë‹ˆë‹¤.

- **SEO(ê²€ìƒ‰ ì—”ì§„ ìµœì í™”)**: ê²€ìƒ‰ ì—”ì§„ì€ ì£¼ë¡œ HTML ì½˜í…ì¸ ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì›¹ íŽ˜ì´ì§€ë¥¼ ìƒ‰ì¸í•˜ê³  ëž­í‚¹ì„ ë§¤ê¸°ëŠ”ë°, CSR ë°©ì‹ì˜ SPAëŠ” ì´ˆê¸° íŽ˜ì´ì§€ ë¡œë”© ì‹œì— ê²€ìƒ‰ ì—”ì§„ í¬ë¡¤ëŸ¬ê°€ ì œëŒ€ë¡œ ë Œë”ë§ëœ ì½˜í…ì¸ ë¥¼ ì¸ì‹í•˜ì§€ ëª»í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤. ì´ë¡œ ì¸í•´ SEOì— ë¶ˆë¦¬í•œ ì˜í–¥ì„ ë¯¸ì¹  ìˆ˜ ìžˆìŠµë‹ˆë‹¤. SSRì€ ì„œë²„ì—ì„œ ì‚¬ì „ì— ë Œë”ë§ëœ HTMLì„ ì œê³µí•˜ì—¬ ê²€ìƒ‰ ì—”ì§„ì´ íŽ˜ì´ì§€ ë‚´ìš©ì„ ë” ìž˜ ì¸ì‹í•˜ê³  ìƒ‰ì¸í•  ìˆ˜ ìžˆë„ë¡ ë•ìŠµë‹ˆë‹¤.
- **ì†Œì…œ ë¯¸ë””ì–´ ê³µìœ **: ì†Œì…œ ë¯¸ë””ì–´ í”Œëž«í¼ì€ ì›¹ íŽ˜ì´ì§€ì˜ ë©”íƒ€ ë°ì´í„°ë¥¼ í™œìš©í•˜ì—¬ ë¯¸ë¦¬ë³´ê¸° ë° ê³µìœ  ì •ë³´ë¥¼ êµ¬ì„±í•©ë‹ˆë‹¤. CSR ë°©ì‹ì˜ SPAëŠ” ì´ˆê¸° ë¡œë”© ì‹œ ë©”íƒ€ ë°ì´í„°ê°€ ë¯¸ë¹„í•˜ì—¬ ê³µìœ  ë¦¬í‚ ì‹œì— ì ì ˆí•œ ì •ë³´ë¥¼ ì œê³µí•˜ì§€ ëª»í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤. SSRì„ í†µí•´ íŽ˜ì´ì§€ê°€ ë¡œë“œë˜ì–´ ê³µìœ  ì‹œì—ë„ ì ì ˆí•œ ë¯¸ë¦¬ë³´ê¸° ì •ë³´ë¥¼ ì œê³µí•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤.
- **ì„±ëŠ¥ ë° ì´ˆê¸° ë¡œë”© ì†ë„ ê°œì„ **: CSRì€ ì´ˆê¸° ë¡œë”© ì‹œì— ëª¨ë“  ë¦¬ì†ŒìŠ¤ë¥¼ ë¡œë“œí•˜ê³  ë Œë”ë§í•´ì•¼ í•˜ê¸° ë•Œë¬¸ì— ì´ˆê¸° ë¡œë”© ì†ë„ê°€ ì§€ì—°ë  ìˆ˜ ìžˆìŠµë‹ˆë‹¤. íŠ¹ížˆ ì´ˆê¸° ë¡œë”©ì— í•„ìš”í•œ ìžë°”ìŠ¤í¬ë¦½íŠ¸ íŒŒì¼ì˜ í¬ê¸°ê°€ í¬ë©´ ì‚¬ìš©ìž ê²½í—˜ì— ì˜í–¥ì„ ì¤„ ìˆ˜ ìžˆìŠµë‹ˆë‹¤. SSRì€ ì„œë²„ì—ì„œ ì‚¬ì „ì— ë Œë”ë§í•˜ì—¬ ì‚¬ìš©ìžì—ê²Œ ë¹ ë¥¸ ì´ˆê¸° íŽ˜ì´ì§€ ë¡œë”©ì„ ì œê³µí•˜ë©°, ì´í›„ í•„ìš”í•œ ìžë°”ìŠ¤í¬ë¦½íŠ¸ íŒŒì¼ì„ ë¡œë“œí•˜ì—¬ ìƒí˜¸ìž‘ìš©ì„±ì„ ìœ ì§€í•©ë‹ˆë‹¤.
- **ìºì‹± ë° ì„±ëŠ¥ ìµœì í™”**: SSRì€ ì„œë²„ ì¸¡ì—ì„œ ì½˜í…ì¸ ë¥¼ ì‚¬ì „ì— ë Œë”ë§í•˜ë¯€ë¡œ í´ë¼ì´ì–¸íŠ¸ì—ê²Œ ë¯¸ë¦¬ ìºì‹œëœ ì½˜í…ì¸ ë¥¼ ì „ì†¡í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤. ì´ëŠ” ì´ˆê¸° ë¡œë”© ì‹œê°„ì„ ì¤„ì´ê³  ì„œë²„ ë¶€í•˜ë¥¼ ê°ì†Œì‹œí‚¬ ìˆ˜ ìžˆìŠµë‹ˆë‹¤.
- **ì ‘ê·¼ì„±**: ì¼ë¶€ ê²€ìƒ‰ ì—”ì§„ ë´‡ì´ë‚˜ ë¸Œë¼ìš°ì €ì—ì„œ ìžë°”ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì§€ì›í•˜ì§€ ì•ŠëŠ” ê²½ìš°ì—ë„ ì ì ˆí•œ ì½˜í…ì¸ ë¥¼ ì œê³µí•˜ê¸° ìœ„í•´ SSRì„ ì‚¬ìš©í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤.

## Next.js í”„ë¡œì íŠ¸ì˜ npm run start ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰ ê³¼ì •

```jsx
// package.json
{
	"scripts": {
    "dev": "next dev",
    "build": "next build",
    "start": "next start",
  },
}
```

Next.jsì—ì„œ `npm run start` ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‹¤í–‰í–ˆì„ ë•Œ `next start` ëª…ë ¹ì–´ê°€ ì‹¤í–‰ë©ë‹ˆë‹¤. [Next.js github ë ˆí¬ì§€í† ë¦¬](https://github.com/vercel/next.js)ì˜ **packages/next/src/cli/next-start.ts**ì—ì„œ `next start` ì‹¤í–‰ ì½”ë“œë¥¼ ì°¾ì„ ìˆ˜ ìžˆì—ˆìŠµë‹ˆë‹¤.

ì´ ì½”ë“œëŠ” `npm run start` ìŠ¤í¬ë¦½íŠ¸ê°€ ì‹¤í–‰ë  ë•Œ í˜¸ì¶œë˜ëŠ” ë©”ì¸ í•¨ìˆ˜ì¸ `nextStart`ê°€ ì„ ì–¸ë˜ì–´ ìžˆìŠµë‹ˆë‹¤. nextStart í•¨ìˆ˜ëŠ” Next.js ì• í”Œë¦¬ì¼€ì´ì…˜ì„ í”„ë¡œë•ì…˜ ëª¨ë“œë¡œ ì‹¤í–‰í•  ë•Œ í•„ìš”í•œ ì»¤ë§¨ë“œ ë¼ì¸ ì˜µì…˜ì„ ì²˜ë¦¬í•˜ê³ , ì„œë²„ë¥¼ ì‹œìž‘í•˜ì—¬ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ í˜¸ìŠ¤íŒ…í•˜ëŠ” ì—­í• ì„ í•©ë‹ˆë‹¤.

```jsx
const nextStart: CliCommand = async (argv) => {
  const validArgs: arg.Spec = {
    // Types
    '--help': Boolean,
    '--port': Number,
    '--hostname': String,
    '--keepAliveTimeout': Number,
    '--experimental-test-proxy': Boolean,

    // Aliases
    '-h': '--help',
    '-p': '--port',
    '-H': '--hostname',
  }
  const args = getValidatedArgs(validArgs, argv)
  if (args['--help']) {
    console.log(`
      Description
        Starts the application in production mode.
        The application should be compiled with \`next build\` first.

      Usage
        $ next start <dir> -p <port>

      <dir> represents the directory of the Next.js application.
      If no directory is provided, the current directory will be used.

      Options
        --port, -p          A port number on which to start the application
        --hostname, -H      Hostname on which to start the application (default: 0.0.0.0)
        --keepAliveTimeout  Max milliseconds to wait before closing inactive connections
        --help, -h          Displays this message
    `)
    process.exit(0)
  }

	...
```

ìƒë‹¨ì—ëŠ” ì»¤ë§¨ë“œ ë¼ì¸ ì˜µì…˜ë“¤ì„ ì •ì˜í•˜ê³ , ì˜µì…˜ì„ ì²˜ë¦¬í•  ìˆ˜ ìžˆë„ë¡ êµ¬ì„±ë˜ì–´ ìžˆìŠµë‹ˆë‹¤. ë§Œì•½ ì‚¬ìš©ìžê°€ `--help` ì˜µì…˜ì„ ì‚¬ìš©í•œë‹¤ë©´ ìŠ¤í¬ë¦½íŠ¸ì˜ ì‚¬ìš©ë²•ê³¼ ì˜µì…˜ ì„¤ëª…ì´ ì¶œë ¥ë©ë‹ˆë‹¤.

```jsx
const nextStart: CliCommand = async (argv) => {
	...

  const dir = getProjectDir(args._[0])
  const host = args['--hostname']
  const port = getPort(args)

  const isExperimentalTestProxy = args['--experimental-test-proxy']

  const keepAliveTimeoutArg: number | undefined = args['--keepAliveTimeout']
  if (
    typeof keepAliveTimeoutArg !== 'undefined' &&
    (Number.isNaN(keepAliveTimeoutArg) ||
      !Number.isFinite(keepAliveTimeoutArg) ||
      keepAliveTimeoutArg < 0)
  ) {
    printAndExit(
      `Invalid --keepAliveTimeout, expected a non negative number but received "${keepAliveTimeoutArg}"`,
      1
    )
  }

  const keepAliveTimeout = keepAliveTimeoutArg
    ? Math.ceil(keepAliveTimeoutArg)
    : undefined

  await startServer({
    dir,
    isDev: false,
    isExperimentalTestProxy,
    hostname: host,
    port,
    keepAliveTimeout,
  })
}
```

`dir`, `host`, `port`, `keepAliveTime` ë“±ì„ ì„¤ì •í•˜ê³  `startServer` í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ì—¬ Next.js ì• í”Œë¦¬ì¼€ì´ì…˜ì„ í”„ë¡œë•ì…˜ ëª¨ë“œë¡œ ì‹¤í–‰í•©ë‹ˆë‹¤.

## ë°°ìš´ ì 

ë§¤ì¼ ëª…ë ¹ì–´ë¥¼ ìž…ë ¥í•˜ë©´ì„œ ì´ ëª…ë ¹ì–´ê°€ ì–´ë–¤ ë¡œì§ìœ¼ë¡œ êµ¬ë™ë˜ëŠ”ì§€ ì „í˜€ ê¶ê¸ˆí•´í•˜ì§€ ì•Šê³  ì‚¬ìš©í–ˆë˜ ê²ƒì´ ë¶€ë„ëŸ¬ì› ìŠµë‹ˆë‹¤ ðŸ¥²Â ê³µì‹ ë ˆí¬ì§€í† ë¦¬ë¥¼ ë³¼ ìƒê°ì€ í•œ ì ì´ ì—†ëŠ”ë°, ì „ë¶€ ì´í•´í•˜ì§„ ëª»í–ˆì§€ë§Œ ê°œë°œ ê³µë¶€ë¥¼ ì–´ë–»ê²Œ í•´ì•¼ í•˜ëŠ”ì§€ ì•Œ ìˆ˜ ìžˆì—ˆë˜ ì˜ë¯¸ ìžˆëŠ” ê²½í—˜ì´ì—ˆìŠµë‹ˆë‹¤.